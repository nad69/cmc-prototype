{% extends "layout.html" %}
{% block page_title %}
Money Claims Prototype
{% endblock %}
{% block proposition_header %}
{% set my_account="4" %}

{% include "includes/propositional_navigation.html" %}
{% endblock %}
{% block content %}
<main id="content" role="main">
  {% include "includes/phase_banner_beta.html" %}
  <div class="grid-row">
    <div class="column-two-thirds">
      <a href="#" class="link-back">Back</a>
      <h1 class="heading-large">

        Suggest instalments for the defendant
      </h1>
      <p class="">Total claim amount is £1643.20.</p>
      <br>
      <form action="court-offer" method="get" class="form">



        <div class="form-group">
          <fieldset>
            <legend class="visually-hidden">Regular payments of</legend>
            <label class="form-label-bold" for="instalment-first-payment">
               Regular payments of
            </label>
                    <p class="form-hint">For example, £10.00</p>

              <input class="fee pound" maxlength="8" size="8" type="text" value=""
              name="instalment-first-payment"
              id="instalment-first-payment">
            </fieldset>

        </div>




        <div class="heading-small">How often you want to receive the payments</div>
        <div class="form-group">
          <fieldset>
            <legend class="visually-hidden">How often you want to receive the payments</legend>
            <div class="multiple-choice">
              <input id="radio-01" type="radio" name="radio-payment-frequency" value="Each week" {{ checked("radio-payment-frequency", "Each week") }}>
              <label for="radio-01" data-target="info-01">Every week</label>
            </div>
            <div class="multiple-choice">
              <input id="radio-02" type="radio" name="radio-payment-frequency" value="Every 2 weeks" {{ checked("radio-payment-frequency", "Every 2 weeks") }}>
              <label for="radio-02" data-target="info-02">Every 2 weeks</label>
            </div>
            <div class="multiple-choice">
              <input id="radio-03" type="radio" name="radio-payment-frequency" value="Every month" {{ checked("radio-payment-frequency", "Each month") }}>
              <label for="radio-03" data-target="info-03">Every month</label>
            </div>
          </fieldset>
        </div>


        <div class="form-group">
          <p class="heading-small">Duration of payments</p>
          <p id="duration">-</p>
        </div>


          <div class="form-group">
            <fieldset>
              <legend class="visually-hidden">Date for first instalment</legend>
              <p class="form-label-bold">Date for first instalment</p>
              <div class="form-date">
                <p class="form-hint">For example, {{ date | date('add', 1, 'month' ) | date('D M YYYY') }}</p>
                <div class="form-group form-group-day">
                  <label for="instalment-day">Day</label>
                  <input class="form-control" id="instalment-day" type="number" pattern="[0-9]*" min="0"
                  max="31">
                </div>
                <div class="form-group form-group-month">
                  <label for="instalment-month">Month</label>
                  <input class="form-control" id="instalment-month" type="number" pattern="[0-9]*"
                  min="0" max="12">
                </div>
                <div class="form-group form-group-year">
                  <label for="instalment-year">Year</label>
                  <input class="form-control" id="instalment-year" type="number" pattern="[0-9]*" min="0"
                  max="2024">
                </div>
              </div>
            </fieldset>
          </div>
          <div class="form-group">
            <input id="advert-option-next--button" type="submit" value="Save and continue" class="button">
          </div>
          </fieldset>
        </div>
      </form>
    </div>
  </div>
</main>

<script>
  $(document).ready(function () {
    $('#instalment-first-payment, input[name=radio-payment-frequency]').change( function() {

      if ( $('#instalment-first-payment').val() && $("input[name=radio-payment-frequency]:checked").length ) {

        var intAmount = 1500;
        var strDuration = '';

        intRepayment = $('#instalment-first-payment').val();

        intInstalments = Math.ceil( intAmount / intRepayment);

        if ($('#radio-01').prop("checked")) {
          intDaysAway = 7;
        } else if ($('#radio-02').prop("checked")) {
          intDaysAway = 14;
        } else if ($('#radio-03').prop("checked")) {
          intDaysAway = 30;
        }

        intRepaymentDays = intDaysAway * intInstalments;
        objDatePaid = moment().add(intRepaymentDays, 'days')
        intYears = objDatePaid.diff( moment(), 'years' );

        if (intYears > 0 ) {
          strDuration = intYears + ' year';
          if (intYears > 1 ) {
            strDuration += 's';
          }
          strDuration += ' ';
          objDatePaid.subtract(intYears, 'years');
        }
        intMonths = objDatePaid.diff( moment(), 'months' );

        if (intMonths) {
          strDuration =  strDuration + intMonths + ' month';
          if (intMonths > 1 ) {
            strDuration += 's';
          }
        }
      $('#duration').text( strDuration );
  


      }
    })
  });
</script>

{% endblock %}
